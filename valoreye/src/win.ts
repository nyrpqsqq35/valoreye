import { execSync } from 'child_process'
// import { Patterns } from './constants'

let buildNumber: string = '10.0.19044.1.256.64bit'

export function getWindowsVersion() {
  // if (!buildNumber) {
  //   const out = execSync(
  //     'Powershell -NoLogo -NonInteractive -NoProfile -ExecutionPolicy Bypass -Encoded WwBTAHkAcwB0AGUAbQAuAFQAZQB4AHQALgBFAG4AYwBvAGQAaQBuAGcAXQA6ADoAVQBUAEYAOAAuAEcAZQB0AFMAdAByAGkAbgBnACgAWwBTAHkAcwB0AGUAbQAuAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACgAJwB7ACIAUwBjAHIAaQBwAHQAIgA6ACIASgBHADEAegBZADIAOQB5AGIARwBsAGkAUABWAHQAQgBjAEgAQgBFAGIAMgAxAGgAYQBXADUAZABPAGoAcABEAGQAWABKAHkAWgBXADUAMABSAEcAOQB0AFkAVwBsAHUATABrAGQAbABkAEUARgB6AGMAMgBWAHQAWQBtAHgAcABaAFgATQBvAEsAWAB3AC8AZQB5AFIAZgBMAGsAWgAxAGIARwB4AE8AWQBXADEAbABMAGwATgB3AGIARwBsADAASwBDAGMAcwBKAHkAbABiAE0ARgAwAHUAVgBHADkATQBiADMAZABsAGMAaQBnAHAASQBDADEAbABjAFMAZAB0AGMAMgBOAHYAYwBtAHgAcABZAGkAZAA5AE8AeQBSAFgAYQBXADQAegBNAGsANQBoAGQARwBsADIAWgBUADAAawBiAFgATgBqAGIAMwBKAHMAYQBXAEkAdQBSADIAVgAwAFYASABsAHcAWgBYAE0AbwBLAFgAdwAvAGUAeQBSAGYATABrAFoAMQBiAEcAeABPAFkAVwAxAGwASQBDADEAbABjAFMAZABOAGEAVwBOAHkAYgAzAE4AdgBaAG4AUQB1AFYAMgBsAHUATQB6AEkAdQBWADIAbAB1AE0AegBKAE8AWQBYAFIAcABkAG0AVQBuAGYAVABzAGsAVAAxAE4AVwBaAFgASgB6AGEAVwA5AHUAUwBXADUAbQBiADAAVgA0AFAAUwBSAFgAYQBXADQAegBNAGsANQBoAGQARwBsADIAWgBTADUASABaAFgAUgBPAFoAWABOADAAWgBXAFIAVQBlAFgAQgBsAGMAeQBnAG4AVABtADkAdQBVAEgAVgBpAGIARwBsAGoASgB5AGwAOABQADMAcwBrAFgAeQA1AEcAZABXAHgAcwBUAG0ARgB0AFoAUwBBAHQAWgBYAEUAbgBUAFcAbABqAGMAbQA5AHoAYgAyAFoAMABMAGwAZABwAGIAagBNAHkATABsAGQAcABiAGoATQB5AFQAbQBGADAAYQBYAFoAbABLADAAOQBUAFYAawBWAFMAVQAwAGwAUABUAGsAbABPAFIAawA5AEYAVwBDAGQAOQBPADIAbABtAEsAQwBSAHUAZABXAHgAcwBJAEMAMQBsAGMAUwBSAFAAVQAxAFoAbABjAG4ATgBwAGIAMgA1AEoAYgBtAFoAdgBSAFgAZwBwAGUAMQBkAHkAYQBYAFIAbABMAFUAVgB5AGMAbQA5AHkASQBDAEoAVgBiAG0ARgBpAGIARwBVAGcAZABHADgAZwBaADIAVgAwAEkARwBFAGcAYwBtAFYAbQBaAFgASgBsAGIAbQBOAGwASQBIAFIAdgBJAEcAdABsAGMAbQA1AGwAYgBEAE0AeQBJAFUAOQBUAFYAbQBWAHkAYwAyAGwAdgBiAGsAbAB1AFoAbQA5AEYAZQBDADQAaQBPADMASgBsAGQASABWAHkAYgBuADAANwBKAEUAMQBoAGEAbQA5AHkAVgBtAFYAeQBjADIAbAB2AGIAagAwAGsAVAAxAE4AVwBaAFgASgB6AGEAVwA5AHUAUwBXADUAbQBiADAAVgA0AEwAawBkAGwAZABFAFoAcABaAFcAeABrAEsAQwBkAE4AWQBXAHAAdgBjAGwAWgBsAGMAbgBOAHAAYgAyADQAbgBMAEYAdABTAFoAVwBaAHMAWgBXAE4AMABhAFcAOQB1AEwAawBKAHAAYgBtAFIAcABiAG0AZABHAGIARwBGAG4AYwAxADAAbgBUAG0AOQB1AFUASABWAGkAYgBHAGwAagBMAEMAQgBKAGIAbgBOADAAWQBXADUAagBaAFMAYwBwAE8AeQBSAE4AYQBXADUAdgBjAGwAWgBsAGMAbgBOAHAAYgAyADQAOQBKAEUAOQBUAFYAbQBWAHkAYwAyAGwAdgBiAGsAbAB1AFoAbQA5AEYAZQBDADUASABaAFgAUgBHAGEAVwBWAHMAWgBDAGcAbgBUAFcAbAB1AGIAMwBKAFcAWgBYAEoAegBhAFcAOQB1AEoAeQB4AGIAVQBtAFYAbQBiAEcAVgBqAGQARwBsAHYAYgBpADUAQwBhAFcANQBrAGEAVwA1AG4AUgBtAHgAaABaADMATgBkAEoAMAA1AHYAYgBsAEIAMQBZAG0AeABwAFkAeQB3AGcAUwBXADUAegBkAEcARgB1AFkAMgBVAG4ASwBUAHMAawBRAG4AVgBwAGIARwBSAE8AZABXADEAaQBaAFgASQA5AEoARQA5AFQAVgBtAFYAeQBjADIAbAB2AGIAawBsAHUAWgBtADkARgBlAEMANQBIAFoAWABSAEcAYQBXAFYAcwBaAEMAZwBuAFEAbgBWAHAAYgBHAFIATwBkAFcAMQBpAFoAWABJAG4ATABGAHQAUwBaAFcAWgBzAFoAVwBOADAAYQBXADkAdQBMAGsASgBwAGIAbQBSAHAAYgBtAGQARwBiAEcARgBuAGMAMQAwAG4AVABtADkAdQBVAEgAVgBpAGIARwBsAGoATABDAEIASgBiAG4ATgAwAFkAVwA1AGoAWgBTAGMAcABPAHkAUgBRAGMAbQA5AGsAZABXAE4AMABWAEgAbAB3AFoAVAAwAGsAVAAxAE4AVwBaAFgASgB6AGEAVwA5AHUAUwBXADUAbQBiADAAVgA0AEwAawBkAGwAZABFAFoAcABaAFcAeABrAEsAQwBkAFEAYwBtADkAawBkAFcATgAwAFYASABsAHcAWgBTAGMAcwBXADEASgBsAFoAbQB4AGwAWQAzAFIAcABiADIANAB1AFEAbQBsAHUAWgBHAGwAdQBaADAAWgBzAFkAVwBkAHoAWABTAGQATwBiADIANQBRAGQAVwBKAHMAYQBXAE0AcwBJAEUAbAB1AGMAMwBSAGgAYgBtAE4AbABKAHkAawA3AEoARgBOADEAYQBYAFIAbABUAFcARgB6AGEAegAwAGsAVAAxAE4AVwBaAFgASgB6AGEAVwA5AHUAUwBXADUAbQBiADAAVgA0AEwAawBkAGwAZABFAFoAcABaAFcAeABrAEsAQwBkAFQAZABXAGwAMABaAFUAMQBoAGMAMgBzAG4ATABGAHQAUwBaAFcAWgBzAFoAVwBOADAAYQBXADkAdQBMAGsASgBwAGIAbQBSAHAAYgBtAGQARwBiAEcARgBuAGMAMQAwAGcASgAwADUAdgBiAGwAQgAxAFkAbQB4AHAAWQB5AHcAZwBTAFcANQB6AGQARwBGAHUAWQAyAFUAbgBLAFQAcwBrAFQAMQBOAFcAWgBYAEoAegBhAFcAOQB1AFMAVwA1AG0AYgAwAE4AdgBiAG4AUgB5AGQAVwBOADAAYgAzAEkAOQBKAEUAOQBUAFYAbQBWAHkAYwAyAGwAdgBiAGsAbAB1AFoAbQA5AEYAZQBDADUASABaAFgAUgBEAGIAMgA1AHoAZABIAEoAMQBZADMAUgB2AGMAbgBNAG8ASwBWAHMAdwBYAFQAcwBrAFQAMQBOAFcAWgBYAEoAegBhAFcAOQB1AFIAWABnADkASgBFADkAVABWAG0AVgB5AGMAMgBsAHYAYgBrAGwAdQBaAG0AOQBEAGIAMgA1ADAAYwBuAFYAagBkAEcAOQB5AEwAawBsAHUAZABtADkAcgBaAFMAZwBrAGIAbgBWAHMAYgBDAGsANwBKAEUAZABsAGQARgBaAGwAYwBuAE4AcABiADIANQBGAGUARAAwAGsAVgAyAGwAdQBNAHoASgBPAFkAWABSAHAAZABtAFUAdQBSADIAVgAwAFQAVwBWADAAYQBHADkAawBLAEMAZABIAFoAWABSAFcAWgBYAEoAegBhAFcAOQB1AFIAWABnAG4ATABGAHQAUwBaAFcAWgBzAFoAVwBOADAAYQBXADkAdQBMAGsASgBwAGIAbQBSAHAAYgBtAGQARwBiAEcARgBuAGMAMQAwAG4AVABtADkAdQBVAEgAVgBpAGIARwBsAGoATABDAEIAVABkAEcARgAwAGEAVwBNAG4ATABDAFIAdQBkAFcAeABzAEwARQBBAG8ASgBFADkAVABWAG0AVgB5AGMAMgBsAHYAYgBrAGwAdQBaAG0AOQBGAGUAQwBrAHMASgBHADUAMQBiAEcAdwBwAE8AMgBsAG0ASwBDAFIAdQBkAFcAeABzAEkAQwAxAGwAYwBTAFIASABaAFgAUgBXAFoAWABKAHoAYQBXADkAdQBSAFgAZwBwAGUAeQBSAEgAWgBYAFIAVwBaAFgASgB6AGEAVwA5AHUAUgBYAGcAOQBXADAAVgB1AGQAbQBsAHkAYgAyADUAdABaAFcANQAwAFgAUwA1AEgAWgBYAFIATgBaAFgAUgBvAGIAMgBRAG8ASgAwAGQAbABkAEYAWgBsAGMAbgBOAHAAYgAyADUARgBlAEMAYwBzAFcAMQBKAGwAWgBtAHgAbABZADMAUgBwAGIAMgA0AHUAUQBtAGwAdQBaAEcAbAB1AFoAMABaAHMAWQBXAGQAegBYAFMAZABPAGIAMgA1AFEAZABXAEoAcwBhAFcATQBzAEkARgBOADAAWQBYAFIAcABZAHkAYwBzAEoARwA1ADEAYgBHAHcAcwBRAEMAZwBrAFQAMQBOAFcAWgBYAEoAegBhAFcAOQB1AFMAVwA1AG0AYgAwAFYANABLAFMAdwBrAGIAbgBWAHMAYgBDAGwAOQBPADIAbABtAEsAQwBSAHUAZABXAHgAcwBJAEMAMQBsAGMAUwBSAEgAWgBYAFIAVwBaAFgASgB6AGEAVwA5AHUAUgBYAGcAcABlADEAZAB5AGEAWABSAGwATABVAFYAeQBjAG0AOQB5AEkAQwBKAFYAYgBtAEYAaQBiAEcAVQBnAGQARwA4AGcAWgAyAFYAMABJAEcARQBnAGMAbQBWAG0AWgBYAEoAbABiAG0ATgBsAEkASABSAHYASQBFAGQAbABkAEYAWgBsAGMAbgBOAHAAYgAyADUARgBlAEMAQgB0AFoAWABSAG8AYgAyAFEAdQBJAGoAdAB5AFoAWABSADEAYwBtADUAOQBPAHkAUgBUAGQAVwBOAGoAWgBYAE4AegBQAFMAUgBIAFoAWABSAFcAWgBYAEoAegBhAFcAOQB1AFIAWABnAHUAUwBXADUAMgBiADIAdABsAEsAQwBSAHUAZABXAHgAcwBMAEUAQQBvAEoARQA5AFQAVgBtAFYAeQBjADIAbAB2AGIAawBWADQASwBTAGsANwBhAFcAWQBvAEwAVwA1AHYAZABDAEEAawBVADMAVgBqAFkAMgBWAHoAYwB5AGwANwBWADMASgBwAGQARwBVAHQAUgBYAEoAeQBiADMASQBvAFcAMABOAHYAYgBYAEIAdgBiAG0AVgB1AGQARQAxAHYAWgBHAFYAcwBMAGwAZABwAGIAagBNAHkAUgBYAGgAagBaAFgAQgAwAGEAVwA5AHUAWABWAHQAUwBkAFcANQAwAGEAVwAxAGwATABrAGwAdQBkAEcAVgB5AGIAMwBCAFQAWgBYAEoAMgBhAFcATgBsAGMAeQA1AE4AWQBYAEoAegBhAEcARgBzAFgAVABvADYAUgAyAFYAMABUAEcARgB6AGQARgBkAHAAYgBqAE0AeQBSAFgASgB5AGIAMwBJAG8ASwBTAGsANwBjAG0AVgAwAGQAWABKAHUAZgBUAHMAawBWAG0AVgB5AGMAMgBsAHYAYgBqADAAaQBkAG0AVgB5AGMAMgBsAHYAYgBqAG8AZwBKAEMAZwBrAFQAVwBGAHEAYgAzAEoAVwBaAFgASgB6AGEAVwA5AHUATABrAGQAbABkAEYAWgBoAGIASABWAGwASwBDAFIAUABVADEAWgBsAGMAbgBOAHAAYgAyADUARgBlAEMAawB1AFYARwA5AFQAZABIAEoAcABiAG0AYwBvAEsAUwBrAGkATwB5AFIAVwBaAFgASgB6AGEAVwA5AHUASwB6ADAAaQBMAGkAUQBvAEoARQAxAHAAYgBtADkAeQBWAG0AVgB5AGMAMgBsAHYAYgBpADUASABaAFgAUgBXAFkAVwB4ADEAWgBTAGcAawBUADEATgBXAFoAWABKAHoAYQBXADkAdQBSAFgAZwBwAEwAbABSAHYAVQAzAFIAeQBhAFcANQBuAEsAQwBrAHAASQBpAEEANwBKAEYAWgBsAGMAbgBOAHAAYgAyADQAcgBQAFMASQB1AEoAQwBnAGsAUQBuAFYAcABiAEcAUgBPAGQAVwAxAGkAWgBYAEkAdQBSADIAVgAwAFYAbQBGAHMAZABXAFUAbwBKAEUAOQBUAFYAbQBWAHkAYwAyAGwAdgBiAGsAVgA0AEsAUwA1AFUAYgAxAE4AMABjAG0AbAB1AFoAeQBnAHAASwBTAEkAZwBPAHkAUgBXAFoAWABKAHoAYQBXADkAdQBLAHoAMABpAEwAaQBRAG8ASgBGAEIAeQBiADIAUgAxAFkAMwBSAFUAZQBYAEIAbABMAGsAZABsAGQARgBaAGgAYgBIAFYAbABLAEMAUgBQAFUAMQBaAGwAYwBuAE4AcABiADIANQBGAGUAQwBrAHUAVgBHADkAVABkAEgASgBwAGIAbQBjAG8ASwBTAGsAaQBJAEQAcwBrAFYAbQBWAHkAYwAyAGwAdgBiAGkAcwA5AEkAaQA0AGsASwBDAFIAVABkAFcAbAAwAFoAVQAxAGgAYwAyAHMAdQBSADIAVgAwAFYAbQBGAHMAZABXAFUAbwBKAEUAOQBUAFYAbQBWAHkAYwAyAGwAdgBiAGsAVgA0AEsAUwA1AFUAYgAxAE4AMABjAG0AbAB1AFoAeQBnAHAASwBTAEkAZwBPAHkAUgBXAFoAWABKAHoAYQBXADkAdQBLAHoAMQBwAFoAaQBnAGsAUgBXADUAMgBPAGwAQgBTAFQAMABOAEYAVQAxAE4AUABVAGwAOQBCAFUAawBOAEkAUwBWAFIARgBRADEAUgBWAFUAawBVAGcATABXAFYAeABJAGsARgBOAFIARABZADAASQBpAGwANwBJAGkANAAyAE4AQwBKADkAWgBXAHgAegBaAFgAcwBpAEwAagBNAHkASQBuADAANwBKAEYAWgBsAGMAbgBOAHAAYgAyADQAcgBQAFMASgBpAGEAWABRAGkATwAxAGQAeQBhAFgAUgBsAEwAVQA5ADEAZABIAEIAMQBkAEMAQQBrAFYAbQBWAHkAYwAyAGwAdgBiAGcAMABLACIAfQAnACAAfAAgAEMAbwBuAHYAZQByAHQARgByAG8AbQAtAEoAcwBvAG4AKQAuAFMAYwByAGkAcAB0ACkAKQAgAHwAIABpAGUAeAA=',
  //     { stdio: 'pipe' /* hide the garbage output */ }
  //   ).toString('utf8')
  //   let matches = out.match(Patterns.WinBuildVersion)
  //   if (!matches) {
  //     buildNumber = '10.0.19044.1.256.64bit' // default
  //   } else {
  //     buildNumber = matches[1]
  //   }
  // }
  return buildNumber
}

export function getTaskList(): string {
  return execSync('tasklist', {
    stdio: 'pipe',
  }).toString('utf8')
}
